<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChainLens | Multi-Chain Asset Scanner</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&family=Syne:wght@700;800&display=swap" rel="stylesheet">

  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script type="module" src="https://unpkg.com/@dexhunterio/swaps@2.0.3/lib/umd/swaps.umd.js"></script>
  <script src="https://terminal.jup.ag/main-v3.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Space Grotesk', 'sans-serif'],
            heading: ['Syne', 'sans-serif'],
          }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Space Grotesk', sans-serif; scroll-behavior: smooth; }
    .font-heading { font-family: 'Syne', sans-serif; }
    .bg-solana-gradient { background: linear-gradient(45deg, #9945FF, #14F195); }
    .bg-solana-gradient-soft { background: linear-gradient(45deg, rgba(153,69,255,0.85), rgba(20,241,149,0.85)); }
    
    /* Toggle Switch Styles */
    .switch-bg { width: 48px; height: 24px; display: flex; align-items: center; padding: 3px; cursor: pointer; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
    .switch-dot { width: 18px; height: 18px; transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
    .translate-x-6 { transform: translateX(24px); }
    
    /* Animations & Scrollbar */
    .modal-enter { animation: fadeIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    
    .dark-scroll::-webkit-scrollbar { width: 8px; }
    .dark-scroll::-webkit-scrollbar-track { background: #0f172a; }
    .dark-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    
    /* Widget Sizing */
    #jupiter-terminal { width: 100%; max-width: 420px; height: 600px; border-radius: 24px; overflow: hidden; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useRef } = React;

    const App = () => {
      const [activeTab, setActiveTab] = useState('portfolio');
      const [evmAddr, setEvmAddr] = useState('');
      const [solAddr, setSolAddr] = useState('');
      const [adaAddr, setAdaAddr] = useState('');
      const [activeChains, setActiveChains] = useState(['ethereum', 'polygon', 'base', 'solana', 'cardano', 'abstract', 'monad']);
      const [nfts, setNfts] = useState([]);
      const [loading, setLoading] = useState(false);
      const [darkMode, setDarkMode] = useState(false);
      const [tokenMode, setTokenMode] = useState(false);
      const [hiddenIds, setHiddenIds] = useState(() => JSON.parse(localStorage.getItem('hiddenAssets') || '[]'));
      const [spamIds, setSpamIds] = useState(() => JSON.parse(localStorage.getItem('spamAssets') || '[]'));

      const chainStyles = {
        ethereum: { color: 'bg-[#3c3c3d]', label: 'Ethereum' },
        polygon: { color: 'bg-[#7B3FE4]', label: 'Polygon' },
        base: { color: 'bg-[#0052FF]', label: 'Base' },
        solana: { color: 'bg-solana-gradient-soft', label: 'Solana' },
        cardano: { color: 'bg-[#0033AD]', label: 'Cardano' },
        monad: { color: 'bg-[#836EF9]', label: 'Monad' },
        abstract: { color: 'bg-[#00FF85] text-black', label: 'Abstract' }
      };

      // Initialization for Trading Hub Widgets
      useEffect(() => {
        if (activeTab === 'trading') {
          // Initialize DexHunter (Cardano)
          if (window.dexhunterSwap) {
            const container = document.getElementById('dexhunter-root');
            if (container) {
              ReactDOM.render(
                React.createElement(window.dexhunterSwap, {
                  orderTypes: ["SWAP", "LIMIT", "DCA"],
                  colors: {
                    background: darkMode ? "#0f172a" : "#FFFFFF",
                    containers: darkMode ? "#1e293b" : "#f8fafc",
                    mainText: darkMode ? "#FFFFFF" : "#0f172a",
                    accent: "#007DFF"
                  },
                  theme: darkMode ? "dark" : "light",
                  swapWidth: 400,
                  partnerName: "ChainLens"
                }),
                container
              );
            }
          }

          // Initialize Jupiter (Solana)
          if (window.Jupiter) {
            window.Jupiter.init({
              displayMode: "integrated",
              integratedTargetId: "jupiter-terminal",
              endpoint: "https://api.mainnet-beta.solana.com",
              theme: darkMode ? "dark" : "light",
            });
          }
        }
      }, [activeTab, darkMode]);

      // --- Logic Helpers ---
      const clearAll = () => {
        setEvmAddr(''); setSolAddr(''); setAdaAddr('');
        setNfts([]);
      };

      const resetEverything = () => {
        if (confirm("Clear all results and reset filters?")) {
          clearAll();
          setHiddenIds([]);
          setSpamIds([]);
          localStorage.removeItem('hiddenAssets');
          localStorage.removeItem('spamAssets');
        }
      };

      const visibleAssets = useMemo(() => {
        return nfts.filter(nft => {
          const rawId = nft.address || nft.id || nft.mint || nft.name;
          const compositeKey = `${nft.chain.toLowerCase()}-${String(rawId).toLowerCase()}`;
          return !hiddenIds.includes(compositeKey) && !spamIds.includes(compositeKey);
        });
      }, [nfts, hiddenIds, spamIds]);

      const handleSearch = async () => {
        setLoading(true);
        // Your scanning logic would execute here
        setTimeout(() => setLoading(false), 1500); 
      };

      const ChainButton = ({ id }) => {
        const style = chainStyles[id];
        const isActive = activeChains.includes(id);
        const activeBgClass = id === 'solana' ? 'bg-solana-gradient' : style.color;
        return (
          <button 
            onClick={() => setActiveChains(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id])} 
            className={`px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-widest transition-all border-2 
            ${isActive ? `${activeBgClass} text-white border-transparent shadow-lg scale-105` 
            : darkMode ? 'bg-slate-800 text-slate-500 border-slate-700' : 'bg-white text-slate-300 border-slate-100'}`}>
            {style.label}
          </button>
        );
      };

      return (
        <div className={`min-h-screen transition-colors duration-500 ${darkMode ? 'bg-slate-950 text-white dark-scroll' : 'bg-slate-50 text-slate-900'}`}>
          
          {/* Global Header & Nav */}
          <div className="flex justify-center pt-8 sticky top-0 z-50">
            <div className={`flex p-1 rounded-2xl border backdrop-blur-md ${darkMode ? 'bg-slate-900/80 border-slate-800' : 'bg-white/80 border-slate-200'}`}>
              <button onClick={() => setActiveTab('portfolio')} className={`px-8 py-3 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${activeTab === 'portfolio' ? 'bg-blue-600 text-white shadow-lg' : 'opacity-50 hover:opacity-100'}`}>Portfolio</button>
              <button onClick={() => setActiveTab('trading')} className={`px-8 py-3 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${activeTab === 'trading' ? 'bg-emerald-600 text-white shadow-lg' : 'opacity-50 hover:opacity-100'}`}>Trading Hub</button>
            </div>
            <button onClick={() => setDarkMode(!darkMode)} className="ml-4 p-3 rounded-xl border border-slate-700 bg-slate-800 text-white hover:bg-slate-700 transition-colors">
              {darkMode ? '‚òÄÔ∏è' : 'üåô'}
            </button>
          </div>

          <div className="max-w-7xl mx-auto p-8">
            {activeTab === 'portfolio' ? (
              <div className="modal-enter">
                <div className="flex flex-col items-center mb-12">
                   <h1 className="text-6xl font-heading font-black tracking-tighter italic">CHAINLENS</h1>
                   <p className="text-[10px] font-bold tracking-[0.3em] uppercase opacity-40">Multi-Chain Asset Scanner</p>
                </div>

                {/* Search Panel */}
                <div className={`p-12 rounded-[3.5rem] shadow-2xl border mb-6 ${darkMode ? 'bg-slate-900/40 border-slate-800 backdrop-blur-xl' : 'bg-white border-slate-100'}`}>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-12 mb-10">
                    <div className="space-y-4">
                      <label className="text-[10px] font-bold uppercase tracking-widest text-slate-500">EVM Chains</label>
                      <input type="text" value={evmAddr} onChange={e => setEvmAddr(e.target.value)} placeholder="0x... or domain" className={`w-full p-4 rounded-xl border outline-none text-sm ${darkMode ? 'bg-slate-950 border-slate-800 focus:border-blue-500' : 'bg-slate-50 border-slate-200'}`} />
                      <div className="flex flex-wrap gap-2">
                        <ChainButton id="ethereum" /><ChainButton id="polygon" /><ChainButton id="base" /><ChainButton id="abstract" /><ChainButton id="monad" />
                      </div>
                    </div>
                    <div className="space-y-4">
                      <label className="text-[10px] font-bold uppercase tracking-widest text-slate-500">Solana Network</label>
                      <input type="text" value={solAddr} onChange={e => setSolAddr(e.target.value)} placeholder="Address..." className={`w-full p-4 rounded-xl border outline-none text-sm ${darkMode ? 'bg-slate-950 border-slate-800 focus:border-emerald-500' : 'bg-slate-50 border-slate-200'}`} />
                      <div className="flex flex-wrap gap-2"><ChainButton id="solana" /></div>
                    </div>
                    <div className="space-y-4">
                      <label className="text-[10px] font-bold uppercase tracking-widest text-slate-500">Cardano Ledger</label>
                      <input type="text" value={adaAddr} onChange={e => setAdaAddr(e.target.value)} placeholder="$handle..." className={`w-full p-4 rounded-xl border outline-none text-sm ${darkMode ? 'bg-slate-950 border-slate-800 focus:border-cyan-500' : 'bg-slate-50 border-slate-200'}`} />
                      <div className="flex flex-wrap gap-2"><ChainButton id="cardano" /></div>
                    </div>
                  </div>
                  
                  <div className="flex flex-col md:flex-row items-center gap-6">
                    <div className="flex items-center space-x-3 px-6 py-4 rounded-2xl border border-white/10 shadow-lg bg-black/5 min-w-[160px]">
                      <span className="text-[10px] font-bold uppercase tracking-widest opacity-60 w-12 text-center">{tokenMode ? 'Tokens' : 'NFTs'}</span>
                      <div onClick={() => setTokenMode(!tokenMode)} className={`switch-bg rounded-full ${tokenMode ? 'bg-emerald-600' : 'bg-slate-300'}`}>
                        <div className={`switch-dot rounded-full bg-white shadow-lg ${tokenMode ? 'translate-x-6' : 'translate-x-0'}`} />
                      </div>
                    </div>
                    <button onClick={handleSearch} disabled={loading} className={`flex-1 py-7 rounded-2xl font-sans font-bold text-4xl uppercase tracking-widest transition-all active:scale-[0.98] ${darkMode ? 'bg-white text-slate-950' : 'bg-slate-950 text-white'}`}>
                      {loading ? 'ANALYZING...' : 'SCAN ASSETS'}
                    </button>
                    <div className="flex gap-2">
                      <button onClick={clearAll} className="px-8 py-7 rounded-xl font-heading font-bold text-xs border-2 border-slate-200 text-slate-400 hover:text-red-500">CLEAR</button>
                      <button onClick={resetEverything} className="px-4 py-7 rounded-xl font-heading font-bold text-xs border-2 border-red-100 text-red-200 hover:bg-red-500 hover:text-white">RESET</button>
                    </div>
                  </div>
                </div>

                {/* Portfolio Display */}
                <div className="grid grid-cols-2 md:grid-cols-5 gap-8">
                  {visibleAssets.map((nft, i) => (
                    <div key={i} className={`border rounded-[2.5rem] p-5 text-center ${darkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-slate-100 hover:-translate-y-2 transition-transform'}`}>
                      <img src={nft.image || `https://via.placeholder.com/400`} className="w-full aspect-square object-cover rounded-3xl mb-4" />
                      <p className="font-heading font-bold text-sm truncate uppercase tracking-tighter">{nft.name}</p>
                    </div>
                  ))}
                </div>
              </div>
            ) : (
              /* Trading Hub View */
              <div className="modal-enter w-full py-10">
                <div className="text-center mb-12">
                  <h1 className="text-5xl font-heading font-extrabold uppercase tracking-tighter mb-2">Cross-Chain Trading</h1>
                  <p className="opacity-50 text-sm font-bold tracking-widest uppercase">Uniswap (EVM) ‚Ä¢ Jupiter (Solana) ‚Ä¢ DexHunter (ADA)</p>
                </div>
                
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 items-start">
                  {/* EVM Section */}
                  <div className={`p-6 rounded-[2.5rem] border shadow-xl flex flex-col items-center ${darkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-slate-200'}`}>
                    <div className="mb-4 flex items-center gap-2">
                      <div className="w-6 h-6 bg-pink-500 rounded-full flex items-center justify-center text-[10px] text-white font-bold">U</div>
                      <span className="text-[10px] font-bold uppercase tracking-widest opacity-60">Uniswap Protocol</span>
                    </div>
                    <iframe
                      src={`https://app.uniswap.org/#/swap?theme=${darkMode ? 'dark' : 'light'}`}
                      height="600px"
                      width="100%"
                      style={{ border: '0', borderRadius: '24px' }}
                    />
                  </div>

                  {/* Solana Section */}
                  <div className={`p-6 rounded-[2.5rem] border shadow-xl flex flex-col items-center ${darkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-slate-200'}`}>
                    <div className="mb-4 flex items-center gap-2">
                      <div className="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center text-[10px] text-white font-bold">J</div>
                      <span className="text-[10px] font-bold uppercase tracking-widest opacity-60">Jupiter Terminal</span>
                    </div>
                    <div id="jupiter-terminal"></div>
                  </div>

                  {/* Cardano Section */}
                  <div className={`p-6 rounded-[2.5rem] border shadow-xl flex flex-col items-center ${darkMode ? 'bg-slate-950 border-slate-800' : 'bg-white border-slate-200'}`}>
                    <div className="mb-4 flex items-center gap-2">
                      <div className="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-[10px] text-white font-bold">D</div>
                      <span className="text-[10px] font-bold uppercase tracking-widest opacity-60">DexHunter Cardano</span>
                    </div>
                    <div id="dexhunter-root" className="w-full min-h-[600px] flex items-center justify-center">
                      <div className="animate-pulse text-slate-500 font-bold text-xs uppercase tracking-widest">Loading Cardano...</div>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>